<html><head></head><body><div hidden=""><dom-module id="nap-product-upsell"><style> :host { overflow:hidden; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -o-user-select: none; user-select: none; } .swiper-prev, .swiper-next { display: none; } @media (min-width: 951px) { .row { -webkit-flex-wrap: inherit; -ms-flex-wrap: inherit; flex-wrap: inherit; } .swiper-prev, .swiper-next { display: block; position: absolute; z-index: 2; top: calc(50% - 90px); cursor: pointer; } .swiper-next { right: 0; } } </style><template><iron-ajax id="getSummaries" auto="" url="//api.net-a-porter.com/product/summaries/data" params="{{_generateParams(pids, limit)}}" handle-as="json" last-response="{{productSummariesApiResponse}}" last-error="{{productSummariesApiError}}" on-request="_onRequest" on-response="_onResponse" on-error="_onError"></iron-ajax><template is="dom-if" if="{{_carouselNeeded(carousel, pids)}}"><div id="upsell-carousel" class="swiper-container"><div class="icon icon-arrow_left swiper-prev"></div><div class="swiper-wrapper row"><template is="dom-repeat" items$="{{productData}}"><nap-product class="col-xs-6 col-sm-4 col-lg-2 swiper-slide" product="{{item}}" itemprop$="{{schemaproperty}}"></nap-product></template></div><div class="icon icon-arrow_right swiper-next"></div></div></template><template is="dom-if" if="{{!_carouselNeeded(carousel, pids)}}"><template is="dom-repeat" items="{{productData}}"><nap-product class="col-xs-6 col-sm-4 col-lg-2" product="{{item}}" itemprop$="{{schemaproperty}}" itemscope="" itemtype="http://schema.org/Product"></nap-product></template></template></template><script>Polymer({is:"nap-product-upsell",properties:{pids:{type:Array,value:[]},productData:Array,limit:{type:Number,value:6},carousel:{type:Boolean,value:false},carouselInstance:Object,schemaproperty:String},_onRequest:function(){NAP.monitoring.registerPerfMark(this.$.getSummaries.url)},_onResponse:function(){this.productData=this.productSummariesApiResponse;if(this.carousel&&this.pids.length>6){var self=this;var carousel=this.$$("#upsell-carousel");carousel.addEventListener("dom-change",function handler(){carousel.removeEventListener("dom-change",handler);self._initCarousel()})}NAP.monitoring.measurePerfMark("Polymer",this.$.getSummaries.url,{status:"success"})},_onError:function(){NAP.monitoring.registerPerfMetricAndMonitoring("Polymer","API Failure",this.$.getSummaries.url,{status:"error",errorThrown:this.productSummariesApiError.error.message})},_generateParams:function(pids,limit){var uniquePids=pids.filter(function(item,pos,self){return self.indexOf(item)===pos});return{business:"NAP",country:NAP.locale.country,lang:NAP.locale.language,limit:limit,offset:0,pids:uniquePids,sort:"input"}},_carouselNeeded:function(carousel,pids){return this.carousel&&this.pids.length>6},_initCarousel:function(){if(window.innerWidth>=951){if(!this.carouselInstance){var self=this;this.carouselInstance=new Swiper(this.$$("#upsell-carousel"),{loop:true,nextButton:this.$$(".swiper-next"),prevButton:this.$$(".swiper-prev"),slidesPerView:6,simulateTouch:false});var dupes=this.querySelectorAll("nap-product.swiper-slide-duplicate");[].forEach.call(dupes,function(dupedProduct){var index=dupedProduct.getAttribute("data-swiper-slide-index");var realProduct=self.querySelector('nap-product[data-swiper-slide-index="'+index+'"]:not(.swiper-slide-duplicate)');dupedProduct.product=realProduct.product})}}else{if(this.carouselInstance){this.carouselInstance.destroy(true,true);this.carouselInstance=null}}},attached:function(){if(this.carousel&&this.pids.length>6){var orientation;var self=this;window.addEventListener("resize",function(){self._initCarousel()});window.addEventListener("deviceorientation",function(){switch(true){case NAP.device.portrait()&&orientation==="landscape":orientation="portrait";self._initCarousel();break;case NAP.device.landscape()&&orientation==="portrait":orientation="landscape";self._initCarousel();break}})}}});</script></dom-module><dom-module id="nap-shoppable-upsell"><style> :host { overflow:hidden; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -o-user-select: none; user-select: none; } :host.row { margin-right: 10px; margin-left: 10px; } :host .row, :host .swiper-wrapper { margin: 0 auto; } nap-product { margin-bottom: 25px; } nap-product:nth-child(n+7) { display: none; } .swiper-prev, .swiper-next { display: none; } @media (min-width: 951px) { .row { -webkit-flex-wrap: inherit; -ms-flex-wrap: inherit; flex-wrap: inherit; } .swiper-prev, .swiper-next { display: block; position: absolute; z-index: 2; top: calc(50% - 90px); cursor: pointer; } .swiper-next { right: 0; } nap-product:nth-child(n+7) { display: flex; } } </style><template><template is="dom-if" if="{{_carouselNeeded(carousel, items)}}"><div id="upsell-carousel" class="swiper-container"><div class="icon icon-arrow_left swiper-prev"></div><div class="swiper-wrapper row"><template is="dom-repeat" items$="{{items}}"><nap-product class="col-xs-6 col-sm-4 col-lg-2 swiper-slide" product="{{item}}" itemprop$="{{schemaproperty}}"></nap-product></template></div><div class="icon icon-arrow_right swiper-next"></div></div></template><template is="dom-if" if="{{!_carouselNeeded(carousel, items)}}"><template is="dom-repeat" items="{{items}}"><nap-product class="col-xs-6 col-sm-4 col-lg-2" product="{{item}}" itemprop$="{{schemaproperty}}" itemscope="" itemtype="http://schema.org/Product"></nap-product></template></template></template><script>Polymer({is:"nap-shoppable-upsell",properties:{items:{type:Array,value:[]},limit:{type:Number,value:6},carousel:{type:Boolean,value:false},carouselInstance:Object,schemaproperty:String},_carouselNeeded:function(carousel,items){return this.carousel&&items.length>6},_initCarousel:function(){var that=this;if(window.innerWidth>=951){if(typeof Swiper==="undefined"){return setTimeout(function(){that._initCarousel()},100)}if(!this.carouselInstance){this.carouselInstance=new Swiper(this.$$("#upsell-carousel"),{loop:true,nextButton:this.$$(".swiper-next"),prevButton:this.$$(".swiper-prev"),slidesPerView:6,simulateTouch:false});var dupes=this.querySelectorAll("nap-product.swiper-slide-duplicate");[].forEach.call(dupes,function(dupedProduct){var index=dupedProduct.getAttribute("data-swiper-slide-index");var realProduct=that.querySelector('nap-product[data-swiper-slide-index="'+index+'"]:not(.swiper-slide-duplicate)');dupedProduct.product=realProduct.product})}}else{if(this.carouselInstance){this.carouselInstance.destroy(true,true);this.carouselInstance=null}}},attached:function(){if(this.carousel&&this.items.length>6){var orientation;var self=this;window.addEventListener("resize",function(){self._initCarousel()});window.addEventListener("deviceorientation",function(){switch(true){case NAP.device.portrait()&&orientation==="landscape":orientation="portrait";self._initCarousel();break;case NAP.device.landscape()&&orientation==="portrait":orientation="landscape";self._initCarousel();break}});self._initCarousel()}}});</script></dom-module><dom-module id="nap-ymal-module"><style> :host { display: none; } .heading { text-transform: uppercase; } nap-product-upsell { margin: 0 10px; } @media all and (min-width: 481px) { nap-product-upsell { width: 82%; margin: 0 auto; } } @media all and (min-width: 951px) { nap-product-upsell { width: 100%; max-width: 1080px; } } </style><template><iron-ajax id="getYmal" auto="" url="{{_ymalUrl(pid)}}" handle-as="json" last-response="{{ymalApiResponse}}" last-error="{{ymalApiError}}" on-request="_onRequest" on-response="_onResponse" on-error="_onError"></iron-ajax><widget-show-hide class="open-lg" name="You May Also Like" open="{{open}}"><div class="show-hide-title heading">{{heading}}</div><div class="show-hide-content"><template is="dom-if" if="{{_pidsExist(ymalApiResponse)}}"><nap-product-upsell id="upsell" class="row center-lg" pids="{{ymalApiResponse.ymalPids}}" limit="{{limit}}" schemaproperty="isSimilarTo"></nap-product-upsell><content select=".view-more"></content></template></div></widget-show-hide></template><script>Polymer({is:"nap-ymal-module",properties:{pid:String,heading:String,limit:Number,open:{type:Boolean,value:false},channelIds:{type:Object,value:{intl:1,am:2,apac:9}}},_onRequest:function(){NAP.monitoring.registerPerfMark(this.$.getYmal.url)},_onResponse:function(){if(this._pidsExist(this.ymalApiResponse)){this.style.display="block"}NAP.monitoring.measurePerfMark("Polymer",this.$.getYmal.url,{status:"success"})},_onError:function(){NAP.monitoring.registerPerfMetricAndMonitoring("Polymer","API Failure",this.$.getYmal.url,{status:"error",errorThrown:this.ymalApiError.error.message})},_ymalUrl:function(pid){return"/api/styling/products/"+pid+"/"+this.channelIds[NAP.locale.channel]+"/ymal.json"},_pidsExist:function(data){return data&&data.ymalPids.length>0},getName:function(){return"You May Also Like"},ready:function(){NAP.webAnalytics.api.addPageFeature("ymal")}});</script></dom-module><dom-module id="nap-htwi-module"><style> :host { display: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -o-user-select: none; user-select: none; } .heading { text-transform: uppercase; } nap-product-upsell { margin: 0 10px; } nap-product-upsell.multiple-outfits { visibility: hidden; height: 0px; } nap-product-upsell.visible { visibility: visible; height: auto; } .outfit-images { padding-bottom: 40px; max-width: 1080px; } .outfit-swiper-prev, .outfit-swiper-next { display: block; position: absolute; z-index: 2; top: calc(50% - 45px); cursor: pointer; } .outfit-swiper-next { right: 0; } .outfit-image-wrapper { width: 45%; font-size: 0; display: inline-block; position: relative; } .outfit-image { width: 100%; } .outfit-image-wrapper .arrow { display: none; } .outfit-image-wrapper.selected { border-width: 0 0 4px 0; border-style: solid; border-color: transparent transparent #000 transparent; padding-bottom: 10px; } .outfit-image-wrapper.selected .arrow { display: block; top: 100%; left: 50%; border: solid transparent; content: " "; height: 0; width: 0; position: absolute; pointer-events: none; border-color: rgba(0, 0, 0, 0); border-top-color: #000; border-width: 13px; margin-left: -13px; } @media all and (min-width: 481px) { nap-product-upsell { width: 82%; margin: 0 auto; } } @media all and (min-width: 951px) { nap-product-upsell { width: 100%; max-width: 1080px; } .swiper-wrapper { display: inline-block; text-align: center; font-size: 0; } .outfit-image-wrapper { width: calc(25% - 4px); margin: 0 2px; cursor: pointer; } .outfit-swiper-prev, .outfit-swiper-next { display: none; } } </style><template><iron-ajax id="getHtwi" auto="" url="{{_htwiUrl(pid)}}" handle-as="json" last-response="{{htwiApiResponse}}" last-error="{{htwiApiError}}" on-request="_onRequest" on-response="_onResponse" on-error="_onError"></iron-ajax><widget-show-hide class="open-lg" name="How To Wear It"><div class="show-hide-title heading">{{heading}}</div><div class="show-hide-content"><template is="dom-if" if="{{_multipleOutfits(htwiApiResponse.outfits)}}"><div class="outfit-images swiper-container" id="outfit-carousel"><div class="icon-carousel_arrow-left outfit-swiper-prev"></div><div class="swiper-wrapper outfit-wrapper"><template is="dom-repeat" items="{{outfits}}"><div class="swiper-slide outfit-image-wrapper" data-index$="{{index}}" on-click="_handleOutfitClick"><img src="{{_outfitImageUrl(item.photoPid, item.photoView)}}" class="outfit-image"><div class="arrow"></div></div></template></div><div class="icon-carousel_arrow-right outfit-swiper-next"></div></div><template is="dom-repeat" items="{{outfits}}"><nap-product-upsell class="row center-lg multiple-outfits" pids="{{_getOutfitPids(item)}}" limit="{{item.products.length}}" carousel="" data-index$="{{index}}" schemaproperty="isRelatedTo"></nap-product-upsell></template></template><template is="dom-if" if="{{_oneOutfit(htwiApiResponse.outfits)}}"><nap-product-upsell id="upsell" class="row center-lg" pids="{{_getOutfitPids(htwiApiResponse.outfits.0)}}" limit="{{htwiApiResponse.outfits.0.products.length}}" carousel="" schemaproperty="isRelatedTo"></nap-product-upsell></template></div></widget-show-hide></template><script>Polymer({is:"nap-htwi-module",properties:{pid:String,heading:String,outfits:Array,channelIds:{type:Object,value:{intl:1,am:2,apac:9}},carouselInstance:Object},_onRequest:function(){NAP.monitoring.registerPerfMark(this.$.getHtwi.url)},_onResponse:function(){if(this._outfitsExist(this.htwiApiResponse.outfits)){if(this._multipleOutfits(this.htwiApiResponse.outfits)){var self=this;this.addEventListener("dom-change",function handler(){var upsell=self.querySelector('nap-product-upsell[data-index="0"]');var firstOutfit=self.querySelector(".outfit-image-wrapper");if(upsell&&firstOutfit){upsell.classList.add("visible");firstOutfit.classList.add("selected");if(self.carouselInstance||window.innerWidth>=951){self.removeEventListener("dom-change",handler)}self._initCarousel()}})}this.outfits=this._trimOutfits(this.htwiApiResponse.outfits);this.style.display="block"}NAP.monitoring.measurePerfMark("Polymer",this.$.getHtwi.url,{status:"success"})},_onError:function(){NAP.monitoring.registerPerfMetricAndMonitoring("Polymer","API Failure",this.$.getHtwi.url,{status:"error",errorThrown:this.htwiApiError.error.message})},_trimOutfits:function(outfits){if(outfits.length>4){return outfits.splice(0,4)}return outfits},_htwiUrl:function(pid){return"/api/styling/products/"+pid+"/"+this.channelIds[NAP.locale.channel]+"/outfits.json"},_outfitImageUrl:function(pid,shot){return"//cache.net-a-porter.com/images/products/"+pid+"/"+pid+"_"+shot+"_pp.jpg"},_getOutfitPids:function(outfit){var validProducts=outfit.products.filter(function(product){return product.slotQueue.length>0});return validProducts.map(function(product){return product.slotQueue[0]})},_outfitsExist:function(outfits){return outfits.length>0},_multipleOutfits:function(outfits){return outfits.length>1},_oneOutfit:function(outfits){return outfits.length===1},_carouselNeeded:function(outfit){return outfit.products.length>6},_updateOutfitAndUpsells:function(newOutfit){var napProductUpsells=this.querySelectorAll("nap-product-upsell");[].forEach.call(napProductUpsells,function(upsell){upsell.classList.remove("visible")});var outfitImages=this.querySelectorAll(".outfit-image-wrapper");[].forEach.call(outfitImages,function(outfit){outfit.classList.remove("selected")});newOutfit.classList.add("selected");var index=newOutfit.getAttribute("data-index");var newUpsell=this.querySelector('nap-product-upsell[data-index="'+index+'"]');if(newUpsell){newUpsell.classList.add("visible")}},_handleOutfitClick:function(event){if(window.innerWidth>=951){this._updateOutfitAndUpsells(event.target.parentNode)}},_initCarousel:function(){if(window.innerWidth<951){if(!this.carouselInstance){if(this.$$("#outfit-carousel")){var self=this;var carousel=new Swiper(this.$$("#outfit-carousel"),{loop:true,nextButton:".outfit-swiper-next",prevButton:".outfit-swiper-prev",slidesPerView:"auto",loopedSlides:this.outfits.length,centeredSlides:true,spaceBetween:4,simulateTouch:false,onSlideChangeStart:function(swiper){var newOutfit=self.querySelector(".outfit-image-wrapper.swiper-slide-active");self._updateOutfitAndUpsells(newOutfit)}});if(carousel.slides.length>0){this.carouselInstance=carousel}}}}else{if(this.carouselInstance){this.carouselInstance.destroy(true,true);this.carouselInstance=null}}},getName:function(){return"How To Wear It"},getOutfitIndex:function(){var activeOutfit=this.querySelector(".outfit-image-wrapper.selected");if(activeOutfit){return activeOutfit.getAttribute("data-index")}else{return"0"}},attached:function(){var orientation;var self=this;window.addEventListener("resize",function(){self._initCarousel()});window.addEventListener("deviceorientation",function(){switch(true){case NAP.device.portrait()&&orientation==="landscape":orientation="portrait";self._initCarousel();break;case NAP.device.landscape()&&orientation==="portrait":orientation="landscape";self._initCarousel();break}});NAP.webAnalytics.api.addPageFeature("htwi")}});</script></dom-module></div></body></html>